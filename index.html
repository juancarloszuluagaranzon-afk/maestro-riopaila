<!doctype html>
<html lang="es" class="dark">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="manifest" href="manifest.json">
<title>Riopaila Agr√≠cola</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com" rel="preconnect">
<link crossorigin href="https://fonts.gstatic.com" rel="preconnect">
<link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;700;800&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet">
<style>
.material-symbols-outlined {
  font-variation-settings: 'FILL' 0,'wght' 400,'GRAD' 0,'opsz' 24;
}
body {
  min-height: max(884px, 100dvh);
  font-family: 'Manrope', sans-serif;
}
</style>
</head>

<body class="bg-slate-50 dark:bg-slate-900 text-slate-800 dark:text-slate-100 flex flex-col items-center justify-center min-h-screen p-6 relative overflow-hidden">
  <!-- Fondo decorativo -->
  <div class="absolute top-0 left-0 w-full h-full bg-gradient-to-br from-teal-50 via-white to-slate-100 dark:from-slate-800 dark:via-slate-900 dark:to-black -z-10"></div>

  <!-- Contenedor principal -->
  <main class="w-full max-w-lg text-center bg-white dark:bg-slate-800/70 backdrop-blur-lg rounded-2xl shadow-xl p-10 border border-slate-200 dark:border-slate-700 relative">
    
    <!-- Logo -->
    <div class="flex justify-center mb-6">
      <div class="w-28 h-28 rounded-full bg-gradient-to-tr from-teal-500 to-teal-300 flex items-center justify-center shadow-lg animate-pulse-slow">
        <img src="icon-192.png" alt="Riopaila Agr√≠cola" class="w-16 h-16">
      </div>
    </div>

    <h1 class="text-3xl font-extrabold tracking-tight mb-2 text-slate-900 dark:text-white">Riopaila Agr√≠cola</h1>
    <h2 class="text-lg font-medium text-slate-600 dark:text-slate-300 mb-3">Maestro de Suertes ¬∑ Transformaci√≥n Digital</h2>
    <span class="inline-block bg-teal-100 text-teal-700 dark:bg-teal-900/50 dark:text-teal-300 px-4 py-1 rounded-full text-sm font-semibold mb-8">üå± Innovando el campo</span>

    <!-- Botones principales -->
    <div class="flex flex-col gap-4">
      <button onclick="window.location.href='maestro.html'" class="w-full py-3 bg-gradient-to-r from-teal-600 to-teal-400 hover:from-teal-500 hover:to-teal-300 text-white font-bold rounded-lg shadow-md transition-transform hover:scale-[1.02]">
        üìã Abrir Maestro
      </button>

      <button onclick="clearCache()" class="w-full py-3 bg-slate-700 hover:bg-slate-600 text-white font-semibold rounded-lg shadow transition-transform hover:scale-[1.02]">
        üîÑ Limpiar Cach√©
      </button>
    </div>

    <!-- Caracter√≠sticas -->
    <div class="mt-10 grid grid-cols-3 gap-4 text-center">
      <div class="flex flex-col items-center gap-2">
        <span class="material-symbols-outlined text-teal-500 text-3xl">bolt</span>
        <p class="text-sm font-semibold">R√°pido</p>
      </div>
      <div class="flex flex-col items-center gap-2">
        <span class="material-symbols-outlined text-teal-500 text-3xl">shield</span>
        <p class="text-sm font-semibold">Seguro</p>
      </div>
      <div class="flex flex-col items-center gap-2">
        <span class="material-symbols-outlined text-teal-500 text-3xl">devices</span>
        <p class="text-sm font-semibold">Adaptable</p>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="mt-6 text-center text-sm text-slate-500 dark:text-slate-400">
    ¬© 2025 Riopaila Agr√≠cola S.A.S. ‚Äî <span class="font-semibold text-teal-500">v1.7.2</span>
  </footer>

  <!-- Service Worker + Clear Cache -->
  <script>
  // Registrar Service Worker
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('service-worker.js')
      .then(() => console.log('Service Worker registrado'))
      .catch(err => console.warn('Error registrando SW:', err));
  }

  // Funci√≥n para limpiar cach√© y recargar
  async function clearCache() {
    try {
      <script>
// ==============================
// üîß Registro mejorado del Service Worker
// ==============================
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('service-worker.js')
    .then(reg => {
      console.log('[Service Worker] Registrado correctamente:', reg.scope);

      // Detectar nuevas versiones del Service Worker
      reg.addEventListener('updatefound', () => {
        const newWorker = reg.installing;
        newWorker.addEventListener('statechange', () => {
          if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
            console.log('‚ö° Nueva versi√≥n disponible. Actualizando...');
            // Activar inmediatamente el nuevo SW
            newWorker.postMessage({ type: 'SKIP_WAITING' });
          }
        });
      });
    })
    .catch(err => console.error('[Service Worker] Error al registrar:', err));

  // Recargar autom√°ticamente cuando el nuevo SW toma control
  navigator.serviceWorker.addEventListener('controllerchange', () => {
    console.log('[Service Worker] Nueva versi√≥n activada. Recargando p√°gina...');
    window.location.reload();
  });
}

// ==============================
// üßπ Funci√≥n para limpiar cach√© y recargar
// ==============================
async function clearCache() {
  try {
    console.log('üßπ Limpiando cach√©...');
    
    if ('serviceWorker' in navigator) {
      const regs = await navigator.serviceWorker.getRegistrations();
      for (const reg of regs) {
        await reg.unregister();
        console.log('üóëÔ∏è Service Worker eliminado:', reg.scope);
      }
    }

    if ('caches' in window) {
      const cacheNames = await caches.keys();
      await Promise.all(cacheNames.map(name => caches.delete(name)));
      console.log('üßæ Cach√©s eliminadas:', cacheNames);
    }

    localStorage.clear();
    alert('‚úÖ Cach√© limpiado correctamente. La aplicaci√≥n se recargar√°.');
    window.location.reload(true);
  } catch (err) {
    console.error('‚ùå Error al limpiar cach√©:', err);
    alert('‚ö†Ô∏è Error al limpiar cach√©. Intenta cerrar y abrir la app nuevamente.');
  }
}
</script>

  <!-- Animaci√≥n lenta de pulso -->
  <style>
  @keyframes pulse-slow {
    0%,100% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.05); opacity: 0.9; }
  }
  .animate-pulse-slow { animation: pulse-slow 4s ease-in-out infinite; }
  </style>
</body>
</html>


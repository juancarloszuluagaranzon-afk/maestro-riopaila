<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Riopaila Agrícola – Maestro de Suertes</title>
<style>
:root{{--bg:#f7fafc;--accent:#0ea5a4;--header-bg:#e9eef0}}
body{{margin:0;font-family:Arial,Helvetica,sans-serif;background:var(--bg);color:#0f172a}}
header{{display:flex;align-items:center;gap:12px;padding:12px 16px;background:var(--header-bg);position:sticky;top:0;z-index:10}}
header img.logo{{width:48px;height:48px;object-fit:contain}}
header .title{{font-size:1.1rem;font-weight:700}}
header .update{{font-size:0.85rem;color:#475569}}
.container{{padding:16px}}
.controls{{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:12px;align-items:center}}
input,button{{padding:8px;border-radius:8px;border:1px solid #e6e9ee}}
button.primary{{background:var(--accent);color:#fff;border:none;padding:8px 12px;border-radius:8px;cursor:pointer}}
.table-wrap{{overflow-x:auto;background:#fff;border-radius:8px;padding:8px}}
table{{border-collapse:collapse;width:100%}}
th,td{{padding:8px;border-bottom:1px solid #eef2f7;white-space:nowrap;text-align:left}}
th{{background:#fbfeff;position:sticky;top:0}}
@media (max-width:600px){{input,button{{padding:6px;font-size:14px}} th,td{{padding:6px;font-size:12px}}}}
</style>
</head>
<body>
<header>
<img src="icon-192.png" class="logo" alt="logo">
<div>
  <div class="title">Riopaila Agrícola – Maestro de Suertes</div>
  <div class="update">Última actualización: 28 de octubre de 2025</div>
</div>
</header>
<div class="container">
  <div class="controls">
    <label>Buscar: <input id="searchInput" placeholder="Buscar..."></label>
    <button id="downloadCsv" class="primary">Descargar CSV</button>
  </div>
  <div class="table-wrap"><table id="maestro"><thead></thead><tbody></tbody></table></div>
  <div style="display:flex;justify-content:center;align-items:center;gap:12px;margin:16px">
    <button id="prevPage" class="primary">← Anterior</button>
    <span id="pageInfo"></span>
    <button id="nextPage" class="primary">Siguiente →</button>
  </div>
</div>
<script>
const HEADERS = {headers_json};
const ROWS = {rows_json};
let currentPage = 1, pageSize = 25;

function renderTable() {{
  const tbody = document.querySelector('#maestro tbody');
  const thead = document.querySelector('#maestro thead');
  const search = document.getElementById('searchInput').value.toLowerCase();
  const filtered = ROWS.filter(r => r.some(v => String(v||'').toLowerCase().includes(search)));
  const totalPages = Math.max(1, Math.ceil(filtered.length / pageSize));
  if (currentPage > totalPages) currentPage = totalPages;
  const start = (currentPage - 1) * pageSize;
  const pageRows = filtered.slice(start, start + pageSize);
  thead.innerHTML = '<tr>' + HEADERS.map(h => '<th>' + h + '</th>').join('') + '</tr>';
  tbody.innerHTML = pageRows.map(r => '<tr>' + r.map(c => '<td>' + c + '</td>').join('') + '</tr>').join('');
  document.getElementById('pageInfo').innerText = `Página ${currentPage} / ${totalPages}`;
}}

document.getElementById('searchInput').addEventListener('input', () => {{ currentPage = 1; renderTable(); }});
document.getElementById('prevPage').addEventListener('click', () => {{ if (currentPage > 1) {{ currentPage--; renderTable(); }} }});
document.getElementById('nextPage').addEventListener('click', () => {{ currentPage++; renderTable(); }});
document.getElementById('downloadCsv').addEventListener('click', () => {{
  const sep = ',', lines = [HEADERS.join(sep)];
  ROWS.forEach(r => lines.push(r.map(c => '"' + String(c||'').replace(/"/g, '""') + '"').join(sep)));
  const blob = new Blob([lines.join('\n')], {{type: 'text/csv;charset=utf-8;'}});
  const a = document.createElement('a'); a.href = URL.createObjectURL(blob);
  a.download = 'Maestro_Riopaila.csv'; a.click();
}});
renderTable();
</script>
</body>
</html>